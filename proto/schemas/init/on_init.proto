syntax = "proto3";

package init_;

import "init/init.proto";

option go_package = "bff-go-mvp/proto/init/gen;init_";

// OnInit response matching the beckn protocol structure
message OnInitResponse {
  OnInitContext context = 1;
  OnInitMessageResponse message = 2;
}

// Context message for on_init response
// Contains both BAP (Buyer App) and BPP (Buyer Provider Platform) information
message OnInitContext {
  string version = 1;
  string action = 2;
  string domain = 3;
  string bpp_id = 4;
  string bpp_uri = 5;
  string transaction_id = 6;
  string message_id = 7;
  string timestamp = 8;
  string ttl = 9;
  string bap_id = 10;
  string bap_uri = 11;
}

// Message containing on_init response data
message OnInitMessageResponse {
  Order order = 1;
}

// Order information
message Order {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  string id = 3; // beckn:id
  string order_status = 4; // beckn:orderStatus
  string order_number = 5; // beckn:orderNumber
  string seller = 6; // beckn:seller
  Buyer buyer = 7; // beckn:buyer
  repeated OrderItem order_items = 8; // beckn:orderItems
  OrderValue order_value = 9; // beckn:orderValue
  Fulfillment fulfillment = 10; // beckn:fulfillment
  Payment payment = 11; // beckn:payment
  OrderAttributes order_attributes = 12; // beckn:orderAttributes
}

// Order item
message OrderItem {
  string line_id = 1; // beckn:lineId
  string ordered_item = 2; // beckn:orderedItem
  AcceptedOffer accepted_offer = 3; // beckn:acceptedOffer
  double quantity = 4; // beckn:quantity
  Price price = 5; // beckn:price
}

// Accepted offer
message AcceptedOffer {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  string id = 3; // beckn:id
  Descriptor descriptor = 4; // beckn:descriptor
  Price price = 5; // beckn:price
  Validity validity = 6; // beckn:validity
  OfferAttributes offer_attributes = 7; // beckn:offerAttributes
}

// Price with applicable quantity
message Price {
  string currency = 1;
  double value = 2;
  ApplicableQuantity applicable_quantity = 3;
}

// Applicable quantity
message ApplicableQuantity {
  string unit_text = 1;
  string unit_code = 2;
  int32 unit_quantity = 3;
}

// Validity period
message Validity {
  string type = 1; // @type JSON-LD field
  string start_date = 2; // schema:startDate
  string end_date = 3; // schema:endDate
}

// Offer attributes
message OfferAttributes {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  string offer_type = 3; // offerType
  BuyerFinderFee buyer_finder_fee = 4; // buyerFinderFee
  double discount_percentage = 5; // discountPercentage
}

// Buyer finder fee
message BuyerFinderFee {
  string fee_type = 1; // feeType
  double fee_value = 2; // feeValue
}

// Order value with components
message OrderValue {
  string currency = 1;
  double value = 2;
  repeated PriceComponent components = 3;
}

// Price component
message PriceComponent {
  string type = 1;
  double value = 2;
  string currency = 3;
  string description = 4;
}

// Payment information
message Payment {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  string id = 3; // beckn:id
  string status = 4; // beckn:status
  Amount amount = 5; // beckn:amount
  string payment_url = 6; // beckn:paymentURL
  string txn_ref = 7; // beckn:txnRef
  string beneficiary = 8; // beckn:beneficiary
  repeated string accepted_payment_method = 9; // beckn:acceptedPaymentMethod
}

// Fulfillment information
message Fulfillment {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  string id = 3; // beckn:id
  string mode = 4; // beckn:mode
  string status = 5; // beckn:status
  DeliveryAttributes delivery_attributes = 6; // beckn:deliveryAttributes
}

// Delivery attributes (ChargingSession)
message DeliveryAttributes {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  string connector_type = 3; // connectorType
  double max_power_kw = 4; // maxPowerKW
  Authorization authorization = 5; // authorization
  string vehicle_make = 6; // vehicleMake
  string vehicle_model = 7; // vehicleModel
}

// Authorization information
message Authorization {
  string type = 1; // type
}

// Order attributes (ChargingSession)
message OrderAttributes {
  string context = 1; // @context JSON-LD field
  string type = 2; // @type JSON-LD field
  SessionPreferences session_preferences = 3; // sessionPreferences
}

